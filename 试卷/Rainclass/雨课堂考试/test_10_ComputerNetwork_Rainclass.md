# 第10次课测试

### 1. [单选题]

有关路由协议，下列说法正确的是

A. RIP使用TCP，OSPF使用IP，BGP使用UDP。

B. RIP存在“好消息传播的快，坏消息传播的慢”的问题。

C. 内部网关协议和外部网关协议都是为了选择最佳路由。

D. RIP周期性的和所有站点交换路由表信息，而OSPF只有当网络拓扑改变时才采用洪泛法广播链路状态信息。

**答案**：B

> **解析：**
>
> *   **A 错误**：RIP 使用 UDP，OSPF 使用 IP，BGP 使用 TCP。
> *   **B 正确**：RIP 基于距离向量算法，存在“计数到无穷”（Count-to-Infinity）问题，表现为好消息传得快，坏消息（链路故障）传得慢。
> *   **C 错误**：内部网关协议（IGP，如RIP、OSPF）主要致力于寻找最佳路由（最短路径）；外部网关协议（EGP，如BGP）主要侧重于策略控制和可达性，寻找一条能够到达目的网络且比较好的路由，而非绝对“最佳”。
> *   **D 错误**：RIP 仅和**相邻**站点交换信息，而不是所有站点。OSPF 也会周期性（如30分钟）刷新链路状态，不仅仅是拓扑改变时。

---

### 2. [填空题]

设某路由器输入端的接收速率为2.5Gbit/s，接收分组的平均长度为256字节，则路由器输入端口的处理速率需至少达到 **[填空1]** Mpps（百万分组每秒，保留小数点后两位）时，才能够跟上线路把分组传送到路由器的速率。

**答案**：

[1] 1.22

> **解析：**
>
> *   **输入速率** $R = 2.5 \text{ Gbit/s} = 2.5 \times 10^9 \text{ bit/s}$。
> *   **分组长度** $L = 256 \text{ Byte} = 256 \times 8 \text{ bit} = 2048 \text{ bit}$。
> *   **包处理速率 (PPS)** = $R / L$
>     $= \frac{2.5 \times 10^9}{2048}$
>     $\approx 1220703 \text{ pps}$
>     $= 1.22 \text{ Mpps}$。

---

### 3. [简答题]

假定网络中的路由器B的路由表有如下的项目（这三列分别表示“目的网络”、“距离”和“下一跳路由器”）:

N1          7            A

N2          2            C

N6          8            F

N8          4            E

N9          4            F

现在B收到从C发来的路由信息（这两列分别表示“目的网络”和“距离””）:

N2          4

N3          8

N6          4

N8          3

N9          5

试求出路由器B更新后的路由表（详细说明每一个步骤）。

**答案**：

（见解析）

> **解析：**
>
> B 收到 C 的路由表，首先将 C 的所有距离 +1（假定 B-C 链路开销为 1），得到 B 通过 C 到达各网络的距离：
> C的通告 -> 经C到达的距离：
> N2: 4 -> 5
> N3: 8 -> 9
> N6: 4 -> 5
> N8: 3 -> 4
> N9: 5 -> 6
>
> **更新步骤：**
> 1.  **N2**：新路由 (N2, 5, C)。原子路由 (N2, 2, C)。**下一跳相同 (都是C)**，必须更新。结果：(N2, 5, C)。
> 2.  **N3**：新路由 (N3, 9, C)。原路由表中无 N3。**添加**。结果：(N3, 9, C)。
> 3.  **N6**：新路由 (N6, 5, C)。原路由 (N6, 8, F)。下一跳不同，新距离 5 < 原距离 8。**更新**。结果：(N6, 5, C)。
> 4.  **N8**：新路由 (N8, 4, C)。原路由 (N8, 4, E)。下一跳不同，新距离 4 = 原距离 4。**不改变**。
> 5.  **N9**：新路由 (N9, 6, C)。原路由 (N9, 4, F)。下一跳不同，新距离 6 > 原距离 4。**不改变**。
> 6.  **N1**：C 未通告 N1。保持不变。
>
> **更新后的路由表：**
> | 目的网络 | 距离 | 下一跳 |
> | :--- | :--- | :--- |
> | N1 | 7 | A |
> | N2 | 5 | C |
> | N3 | 9 | C |
> | N6 | 5 | C |
> | N8 | 4 | E |
> | N9 | 4 | F |

---

### 4. [简答题]

网络如下图所示。假定AS1和AS4运行RIP，AS2和AS3运行OSPF。AS之间运行eBGP和iBGP。目前先假定在AS2和AS4之间没有物理连接（图中的虚线表示这个假定）。

![image](https://qn-sc0.yuketang.cn/ue_i/20211114/14f89147-42ea-4bd3-afed-6cefd5a6d24f.png)

试回答：

（1）路由器R3c使用哪个协议知道前缀X（X在AS4中）？

（2）路由器R1d使用哪个协议知道前缀X？

（3）当路由器R1d将前缀X的路由写入转发表后。若收到一个目的地址前缀为X的分组，R1d应当从接口1还是接口2转发该分组？请简述理由。

（4）现假定AS2和AS4之间有物理连接，即图中的虚线变成了实线。假定路由器R1d知道到达前缀X可以经过AS2，但也可以经过AS3。试问路由器R1d应当从接口1还是接口2转发分组？请简述理由。

**答案**：

（见解析）

> **解析：**
>
> **(1)**
> X 位于 AS4。R3c 位于 AS3 的边界，直接与 AS4 的 R4a 相连。
> 不同 AS 之间的路由信息传递使用 **eBGP** 协议。
> 因此 R3c 通过 eBGP 从 R4a 获知前缀 X。
>
> **(2)**
> R1d 位于 AS1 内部。AS1 需要从外部（AS3 或 AS2）学习路由。
> R1c（AS1边界）通过 eBGP 从 AS3 学习到 X，然后通过 **iBGP** 将 X 的路由信息告诉 AS1 内部的 R1d。
>
> **(3)**
> **接口 1**。
> R1d 通过 iBGP 知道去往 X 的出口是 R1c。
> AS1 内部运行 RIP。R1d 此时需要查找去往 iBGP 下一跳（R1c）的最佳路径。
> 根据 RIP（跳数最少），R1d 到 R1c 最近的路径通常是直连或经过 R1a。
> 题目图中暗示 R1d 的接口 1 连接 R1a，R1a 连接 R1c（假设逻辑结构如此，或接口1指向 AS3 方向的路径）。根据解析提示，通过 RIP 获得的到 R1c 的下一跳是 R1a，而 R1a 连在 R1d 的接口 1 上。
>
> **(4)**
> **接口 2**。
> 当 AS2 和 AS4 连通后，R1d 学习到有两条路径去往 AS4（经 AS2 或 经 AS3）。
> BGP 在选择路由时，有一条规则是“**热土豆路由**” (Hot Potato Routing)，即尽量把分组尽快送出本 AS。
> R1d 会比较到 AS2 边界路由器 (R1b) 和 AS3 边界路由器 (R1c) 的内部开销 (IGP Cost)。
> 从图上看，R1d 离 R1b 更近（假设接口 2 直连 R1b，或者跳数更少）。
> 因此，R1d 会选择内部开销最小的出口，即通过接口 2 转发给 R1b。

---
