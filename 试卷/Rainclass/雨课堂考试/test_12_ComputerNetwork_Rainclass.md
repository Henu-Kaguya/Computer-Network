# 第12次课测试

### 1. [填空题]

从通信和信息处理的角度看，运输层向它上面的应用层提供通信服务，它属于面向  **[填空1]**  部分的最高层，同时也是  **[填空2]**  功能中的最低层。

**答案**：

[1] 通信
[2] 用户

> **解析：**
>
> 运输层是计算机网络体系结构中至关重要的一层。
> *   从通信角度看，它属于面向**通信**部分的最高层，负责为应用进程提供端到端的逻辑通信。
> *   从信息处理角度看，它属于面向**用户**（应用）功能中的最低层，屏蔽了底层网络核心的细节。

---

### 2. [填空题]

一个UDP用户数据报的首部十六进制表示是：06 32 00 45 00 1C E2 17。则其源端口表示的十进制数是 **[填空1]** 、目的端口表示的十进制数是 **[填空2]** 、用户数据报的总长度为 **[填空3]** 字节、数据部分长度为 **[填空4]** 字节。此用户数据报是从客户发送给服务器的吗？ **[填空5]** （是，不是）使用此UDP的服务器程序是 **[填空6]** 。

**答案**：

[1] 1586
[2] 69
[3] 28
[4] 20
[5] 是
[6] TFTP

> **解析：**
>
> UDP首部格式（8字节）：源端口(2B) | 目的端口(2B) | 长度(2B) | 检验和(2B)
>
> 1.  **源端口**：`06 32` (16进制) = $6 \times 256 + 50 = 1586$。
> 2.  **目的端口**：`00 45` (16进制) = $69$。
> 3.  **总长度**：`00 1C` (16进制) = $16 + 12 = 28$ 字节。
> 4.  **数据长度**：总长度 - 首部长度 = $28 - 8 = 20$ 字节。
> 5.  **方向**：目的端口 69 是 **TFTP** 协议的熟知端口（服务器端监听端口）。源端口 1586 是短暂端口（客户端使用）。因此是从客户发送给服务器的。
> 6.  **协议**：使用端口 69 的服务器程序是 **TFTP** (简单文件传输协议)。

---

### 3. [多选题]

假定使用连续ARQ协议，发送窗口大小是3，序号范围是[0，15]，而传输媒体保证在接收方能够按序收到分组。在某一时刻，接收方下一个期望收到的序号是5。则以下哪些序号组合可能出现在发送方的发送窗口？

A. [1,3]

B. [2,4]

C. [3,5]

D. [4,6]

E. [5,7]

**答案**：B, C, D, E

> **解析：**
>
> *   **接收方期望收到 5**：说明接收方已经正确接收并确认了序号 0 到 4 的分组。意味着接收方发送了 `ACK 5`（或累计确认到4）。
> *   由于 ACK 可能在传输途中滞后或丢失，发送方可能还不知道这一情况。
> *   **情况 1 (ACK 丢失或滞后)**：发送方刚发完 2, 3, 4，等待确认。此时窗口可能是 `[2, 4]` (假定已确认了1，正在发2,3,4? 不，如果窗口由ACK推动。若收到ACK 2(期望2)，窗口[2,4]。若收到ACK 3，窗口[3,5]...
>     *   若发送方只收到 ACK 2，窗口为 `[2, 4]`。
>     *   若发送方只收到 ACK 3，窗口为 `[3, 5]`。
>     *   若发送方只收到 ACK 4，窗口为 `[4, 6]`。
>     *   若发送方收到了 ACK 5，窗口为 `[5, 7]`。
> *   **排除 A [1, 3]**：如果窗口是 [1, 3]，说明发送方还没发出 4。但接收方已经收到 4 了（期望 5）。这不可能（除非重传旧的? 但这里讨论正常滑动）。
> *   因此，可能的状态是 B, C, D, E。

---

### 4. [简答题]

主机A向主机B发送一个很长的文件，其长度为L字节。假定TCP使用的MSS为1460字节。

（1）在TCP的序号不重复使用的条件下，L的最大值是多少？

（2）假定使用上面计算出的文件长度，而运输层、网络层和数据链路层所用的首部开销共66字节，链路的数据率为10Mb/s，试求这个文件所需的最短发送时间。

**答案**：

（见解析）

> **解析：**
>
> **(1)**
> TCP 序号字段占 32 位。
> 在序号不重复使用的情况下，最大传输量为 $2^{32}$ 字节。
> $L_{max} = 2^{32} \text{ Byte} = 4 \text{ GB}$。
>
> **(2)**
> *   **文件长度** $L = 4294967296$ 字节。
> *   **MSS** = 1460 字节。
> *   **分片数量** $Q = \lfloor L / MSS \rfloor = \lfloor 4294967296 / 1460 \rfloor = 2941758$ 个满载片。
>     剩余数据 $R = L \mod MSS = 616$ 字节。
> *   **总报文长度**：
>     每个满载片增加 66 字节开销。
>     最后一个非满载片也增加 66 字节开销。
>     总发送字节 $N = L + (Q + 1) \times 66$
>     $N = 4294967296 + (2941759) \times 66$
>     $N = 4294967296 + 194156094 = 4489123390 \text{ 字节}$。
> *   **发送时间**：
>     $t = \frac{N \times 8}{10 \times 10^6} = \frac{4489123390 \times 8}{10^7} = 3591.298... \text{ 秒}$。
>     约等于 **3591.3 秒** (或约 59.85 分钟)。

---
